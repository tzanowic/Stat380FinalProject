---
title: "STAT 380 Final Project"
author: "Tristan Zanowic, Evan Spinney, Julian Sim"
output: html_notebook
---

# Front Matter

## Clear Environment
```{r}
# rm(list = ls())
```

## Library Calls
```{r}
library(tidyverse)
library(Lahman)
library(reshape2)
library(mdsr)
library(mvtnorm)
library(factoextra)
library(cluster)
library(leaps)
library(caret)
library(ISLR2)
library(olsrr)
```

## Loading Data
```{r}
FullStats <- read.csv("FullStats.csv")
FullStats <-
  FullStats %>%
  rename(deathsper100000 = Deaths...cumulative.total.per.100000.population, casesper100000 = Cases...cumulative.total.per.100000.population)
head(FullStats)
VaccineData <- read.csv("vaccination-data.csv")
FullStats$gdpcap <- FullStats$gdpcap/1000
FullStats$AirTransport <- FullStats$AirTransport/1000
FullStats$HealthExppCap <- FullStats$HealthExppCap/100
```



# Exploratory Data Analysis

## COVID-19 Rates by Geographical Region
```{r}
FullStats %>%
  group_by(WHO.Region) %>%
  summarise(countries = n(), avgcovidcases = mean(totalcases), avgcoviddeaths = mean(totaldeaths), deathrate = (avgcoviddeaths/avgcovidcases))
```

## Exploring Death Rates vs Other Parameters
```{r}
FullStats %>%
  ggplot(aes(x = (gdpcap), y = deathrate, na.rm = TRUE)) +
  geom_point(aes(color = WHO.Region)) 
FullStats %>%
  ggplot(aes(x = (urbpop), y = deathrate, na.rm = TRUE)) +
  geom_point(aes(color = WHO.Region)) 
```

## Identifying Outliers

```{r}
# YEMEN, MONACO
```

## Multiple Linear Regression - Deaths per 100000

```{r}
# All Variables
deathrate.fit <- lm(data = FullStats, deathsper100000 ~ urbpop + AgeDependancy + HospitalBeds  + gdpcap:PovertyRate + urbpop:HospitalBeds + PovertyRate:HospitalBeds + 0 , na.rm = TRUE)
summary(deathrate.fit)
AIC(deathrate.fit)
```

```{r}
# 34
deathrate.fit <- lm(data = FullStats, deathsper100000 ~ gdpcap + urbpop  + AirTransport + AgeDependancy + MilitaryEx + HospitalBeds  + gdpcap:HealthExppCap + gdpcap:urbpop + urbpop:AgeDependancy + gdpcap:PovertyRate + urbpop:HospitalBeds + PovertyRate:HospitalBeds + AirTransport:gdpcap + 0 , na.rm = TRUE)
summary(deathrate.fit)
AIC(deathrate.fit)
```

```{r}
AllModels <- ols_step_all_possible(deathrate.fit)
```


# Multiple Linear Regression - Cases Per 100000
```{r}
# Case Rate - All Vars
caserate.fit <- lm(data = FullStatsNA, casesper100000 ~  gdpcap + urbpop + HealthExppCap + AirTransport + AgeDependancy + MilitaryEx + HospitalBeds + PovertyRate, na.rm = TRUE)
summary(caserate.fit)



```